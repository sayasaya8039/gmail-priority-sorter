import{c as O,j as s,r as i}from"./client-C3Ze0Hgb.js";import{g as G,u as r}from"./storage-CS1t7rav.js";const m={critical:{label:"ç·Šæ€¥",color:"#DC2626",bgColor:"#FEE2E2"},high:{label:"é«˜",color:"#EA580C",bgColor:"#FFEDD5"},medium:{label:"ä¸­",color:"#2563EB",bgColor:"#DBEAFE"},low:{label:"ä½",color:"#6B7280",bgColor:"#F3F4F6"}},g={urgent:{label:"ç·Šæ€¥",icon:"ğŸš¨"},important:{label:"é‡è¦",icon:"â­"},meeting:{label:"ä¼šè­°",icon:"ğŸ“…"},action:{label:"è¦å¯¾å¿œ",icon:"ğŸ“‹"},fyi:{label:"å‚è€ƒ",icon:"ğŸ“"},newsletter:{label:"ãƒ‹ãƒ¥ãƒ¼ã‚¹",icon:"ğŸ“°"},promotion:{label:"ãƒ—ãƒ­ãƒ¢",icon:"ğŸ·ï¸"},social:{label:"SNS",icon:"ğŸ’¬"},other:{label:"ãã®ä»–",icon:"ğŸ“§"}},T=()=>{const[a,l]=i.useState(null),[x,E]=i.useState([]),[L,R]=i.useState(!0),[h,I]=i.useState({critical:0,high:0,medium:0,low:0}),[d,j]=i.useState("stats"),[u,b]=i.useState(""),[p,v]=i.useState("");i.useEffect(()=>(F(),chrome.runtime.onMessage.addListener(y),w(),()=>{chrome.runtime.onMessage.removeListener(y)}),[]);const y=i.useCallback(e=>{e.type==="EMAILS_CLASSIFIED"&&e.emails&&(E(e.emails),D(e.emails))},[]),w=()=>{chrome.tabs.query({active:!0,currentWindow:!0},e=>{const t=e[0];t?.id&&t.url?.includes("mail.google.com")&&chrome.tabs.sendMessage(t.id,{type:"REFRESH"}).catch(()=>{console.log("Gmail Priority Sorter: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«æ¥ç¶šã§ãã¾ã›ã‚“ã€‚ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚")})})},F=async()=>{try{const e=await G();l(e)}catch(e){console.error("è¨­å®šã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",e)}finally{R(!1)}},D=e=>{const t={critical:0,high:0,medium:0,low:0};e.forEach(n=>{n.priority in t&&t[n.priority]++}),I(t)},N=async e=>{if(!a)return;const t=!a[e],n={...a,[e]:t};l(n),await r({[e]:t})},o=()=>{w()},C=()=>{chrome.runtime.openOptionsPage()},S=async()=>{if(!a||!u.trim())return;const e=[...a.vipList,u.trim()],t={...a,vipList:e};l(t),await r({vipList:e}),b(""),o()},P=async e=>{if(!a)return;const t=a.vipList.filter(c=>c!==e),n={...a,vipList:t};l(n),await r({vipList:t}),o()},f=async()=>{if(!a||!p.trim())return;const e=[...a.ignoreList,p.trim()],t={...a,ignoreList:e};l(t),await r({ignoreList:e}),v(""),o()},V=async e=>{if(!a)return;const t=a.ignoreList.filter(c=>c!==e),n={...a,ignoreList:t};l(n),await r({ignoreList:t}),o()},B=async e=>{if(!a)return;const t=a.customRules.map(c=>c.id===e?{...c,enabled:!c.enabled}:c),n={...a,customRules:t};l(n),await r({customRules:t}),o()},A=async e=>{if(!a)return;const t=a.customRules.filter(c=>c.id!==e),n={...a,customRules:t};l(n),await r({customRules:t}),o()};if(L)return s.jsx("div",{className:"sidepanel-container",children:s.jsx("div",{className:"loading",children:"èª­ã¿è¾¼ã¿ä¸­..."})});const M=chrome.runtime.getManifest().version;return s.jsxs("div",{className:"sidepanel-container",children:[s.jsxs("header",{className:"sidepanel-header",children:[s.jsxs("div",{className:"logo",children:[s.jsx("span",{className:"logo-icon",children:"ğŸ“§"}),s.jsx("h1",{children:"Priority Sorter"})]}),s.jsxs("span",{className:"version",children:["v",M]})]}),s.jsxs("nav",{className:"tab-nav",children:[s.jsx("button",{className:`tab-btn ${d==="stats"?"active":""}`,onClick:()=>j("stats"),children:"ğŸ“Š çµ±è¨ˆ"}),s.jsx("button",{className:`tab-btn ${d==="vip"?"active":""}`,onClick:()=>j("vip"),children:"â­ VIP/ç„¡è¦–"}),s.jsx("button",{className:`tab-btn ${d==="rules"?"active":""}`,onClick:()=>j("rules"),children:"ğŸ“‹ ãƒ«ãƒ¼ãƒ«"})]}),d==="stats"&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"stats-section",children:[s.jsx("h2",{children:"ğŸ“Š ãƒ¡ãƒ¼ãƒ«çµ±è¨ˆ"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card critical",children:[s.jsx("span",{className:"stat-count",children:h.critical}),s.jsx("span",{className:"stat-label",children:"ç·Šæ€¥"})]}),s.jsxs("div",{className:"stat-card high",children:[s.jsx("span",{className:"stat-count",children:h.high}),s.jsx("span",{className:"stat-label",children:"é«˜"})]}),s.jsxs("div",{className:"stat-card medium",children:[s.jsx("span",{className:"stat-count",children:h.medium}),s.jsx("span",{className:"stat-label",children:"ä¸­"})]}),s.jsxs("div",{className:"stat-card low",children:[s.jsx("span",{className:"stat-count",children:h.low}),s.jsx("span",{className:"stat-label",children:"ä½"})]})]})]}),s.jsxs("section",{className:"settings-section",children:[s.jsx("h2",{children:"âš™ï¸ ã‚¯ã‚¤ãƒƒã‚¯è¨­å®š"}),s.jsxs("div",{className:"toggle-list",children:[s.jsxs("label",{className:"toggle-item",children:[s.jsx("span",{children:"æ‹¡å¼µæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–"}),s.jsx("input",{type:"checkbox",checked:a?.enabled??!0,onChange:()=>N("enabled")}),s.jsx("span",{className:"toggle-switch"})]}),s.jsxs("label",{className:"toggle-item",children:[s.jsx("span",{children:"ãƒãƒƒã‚¸è¡¨ç¤º"}),s.jsx("input",{type:"checkbox",checked:a?.showBadges??!0,onChange:()=>N("showBadges")}),s.jsx("span",{className:"toggle-switch"})]}),s.jsxs("label",{className:"toggle-item",children:[s.jsx("span",{children:"ã‚¹ã‚³ã‚¢è¡¨ç¤º"}),s.jsx("input",{type:"checkbox",checked:a?.showScores??!0,onChange:()=>N("showScores")}),s.jsx("span",{className:"toggle-switch"})]})]})]}),x.length>0&&s.jsxs("section",{className:"emails-section",children:[s.jsxs("h2",{children:["ğŸ“¬ åˆ†é¡æ¸ˆã¿ãƒ¡ãƒ¼ãƒ« (",x.length,"ä»¶)"]}),s.jsx("ul",{className:"email-list",children:x.slice(0,20).map((e,t)=>{const n=m[e.priority]||m.medium,c=g[e.category]||g.other;return s.jsxs("li",{className:"email-item",children:[s.jsx("div",{className:"email-priority",style:{background:n.bgColor,color:n.color},children:n.label}),s.jsxs("div",{className:"email-content",children:[s.jsxs("div",{className:"email-sender",children:[c.icon," ",e.sender]}),s.jsx("div",{className:"email-subject",children:e.subject||"(ä»¶åãªã—)"})]}),s.jsx("div",{className:"email-score",style:{background:n.color},children:e.urgencyScore})]},t)})})]})]}),d==="vip"&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"list-section",children:[s.jsx("h2",{children:"â­ VIPãƒªã‚¹ãƒˆ"}),s.jsx("p",{className:"section-desc",children:"å¸¸ã«é«˜å„ªå…ˆåº¦ã§è¡¨ç¤ºã™ã‚‹é€ä¿¡è€…"}),s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:"text",placeholder:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‰ãƒ¡ã‚¤ãƒ³",value:u,onChange:e=>b(e.target.value),onKeyDown:e=>e.key==="Enter"&&S()}),s.jsx("button",{className:"btn-add",onClick:S,children:"è¿½åŠ "})]}),s.jsxs("ul",{className:"tag-list",children:[a?.vipList.map((e,t)=>s.jsxs("li",{className:"tag vip-tag",children:[s.jsx("span",{children:e}),s.jsx("button",{className:"tag-remove",onClick:()=>P(e),children:"Ã—"})]},t)),(!a?.vipList||a.vipList.length===0)&&s.jsx("li",{className:"empty-message",children:"VIPãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“"})]})]}),s.jsxs("section",{className:"list-section",children:[s.jsx("h2",{children:"ğŸš« ç„¡è¦–ãƒªã‚¹ãƒˆ"}),s.jsx("p",{className:"section-desc",children:"å¸¸ã«ä½å„ªå…ˆåº¦ã§è¡¨ç¤ºã™ã‚‹é€ä¿¡è€…"}),s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:"text",placeholder:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‰ãƒ¡ã‚¤ãƒ³",value:p,onChange:e=>v(e.target.value),onKeyDown:e=>e.key==="Enter"&&f()}),s.jsx("button",{className:"btn-add",onClick:f,children:"è¿½åŠ "})]}),s.jsxs("ul",{className:"tag-list",children:[a?.ignoreList.map((e,t)=>s.jsxs("li",{className:"tag ignore-tag",children:[s.jsx("span",{children:e}),s.jsx("button",{className:"tag-remove",onClick:()=>V(e),children:"Ã—"})]},t)),(!a?.ignoreList||a.ignoreList.length===0)&&s.jsx("li",{className:"empty-message",children:"ç„¡è¦–ãƒªã‚¹ãƒˆã¯ç©ºã§ã™"})]})]})]}),d==="rules"&&s.jsxs("section",{className:"rules-section",children:[s.jsx("h2",{children:"ğŸ“‹ ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«"}),s.jsx("p",{className:"section-desc",children:"è©³ç´°è¨­å®šã§ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã§ãã¾ã™"}),a?.customRules&&a.customRules.length>0?s.jsx("ul",{className:"rule-list",children:a.customRules.map(e=>s.jsxs("li",{className:"rule-item",children:[s.jsxs("div",{className:"rule-header",children:[s.jsxs("label",{className:"toggle-item compact",children:[s.jsx("input",{type:"checkbox",checked:e.enabled,onChange:()=>B(e.id)}),s.jsx("span",{className:"toggle-switch small"})]}),s.jsx("span",{className:"rule-name",children:e.name}),s.jsx("button",{className:"btn-delete",onClick:()=>A(e.id),children:"ğŸ—‘ï¸"})]}),s.jsxs("div",{className:"rule-details",children:[s.jsx("span",{className:"rule-priority",style:{background:m[e.priority]?.bgColor,color:m[e.priority]?.color},children:m[e.priority]?.label}),s.jsxs("span",{className:"rule-category",children:[g[e.category]?.icon," ",g[e.category]?.label]}),s.jsxs("span",{className:"rule-boost",children:["+",e.scoreBoost,"pt"]})]}),s.jsx("div",{className:"rule-conditions",children:e.conditions.map((t,n)=>s.jsxs("span",{className:"condition-tag",children:[t.field,": ",t.value]},n))})]},e.id))}):s.jsxs("div",{className:"empty-rules",children:[s.jsx("p",{children:"ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“"}),s.jsx("button",{className:"btn btn-secondary",onClick:C,children:"âš™ï¸ è©³ç´°è¨­å®šã§ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ "})]})]}),s.jsxs("section",{className:"actions-section",children:[s.jsx("button",{className:"btn btn-primary",onClick:o,children:"ğŸ”„ å†åˆ†é¡"}),s.jsx("button",{className:"btn btn-secondary",onClick:C,children:"âš™ï¸ è©³ç´°è¨­å®š"})]}),s.jsx("footer",{className:"sidepanel-footer",children:s.jsx("p",{children:"Gmailã‚’é–‹ãã¨è‡ªå‹•ã§åˆ†é¡ã•ã‚Œã¾ã™"})})]})},k=document.getElementById("root");k&&O.createRoot(k).render(s.jsx(T,{}));
